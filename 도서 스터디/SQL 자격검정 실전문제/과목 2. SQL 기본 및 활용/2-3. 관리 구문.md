
```table-of-contents
```

### 1. DML
#### INSERT
- 데이터 입력
	```
	INSERT INTO 테이블명 (칼럼명, …) VALUES (필드값, …);
	INSERT INTO 테이블명 VALUES (필드값, …);
	```
- 문자열 타입의 칼럼에 `공백문자('')`를 insert할 경우 `오라클은 NULL`로 입력되고, `SQL Server는 공백문자('')`로 입력됨
- ex) 서비스번호, 서비스명, 개시일자 칼럼으로 구성된 서비스 테이블에 `INSERT INTO 서비스 VALUES ('999', '', '2015-11-11');` 로 데이터를 입력할 경우,
	- 서비스명 칼럼의 데이터에 대해서 오라클에서는 NULL로, SQL Server는 ''로 입력됨
	- `SELECT * FROM 서비스 WHERE 서비스명 = '';` 로 조회하면 데이터는 조회되지 않고, `서비스명 IS NULL` 조건으로 조회하여야 함
	- SQL Server에서는 `SELECT * FROM 서비스 WHERE 서비스명 = '';` 로 조회 가능

#### UPDATE
- 데이터 수정
	```
	UPDATE 테이블명 SET 칼럼명=필드값;
	```

#### DELETE
- 데이터 삭제
	```
	DELETE FROM 테이블명 WHERE 조건절;
	DELETE FROM 테이블명;
	```
- DELETE로 데이터를 삭제해도 테이블 용량은 초기화되지 않음 (<-> TRUNCATE로 삭제하면 초기화됨)
- <-> DROP은 객체 삭제 명령어

#### SELECT
- 데이터 선택
	```
	SELECT [ALL/DISTINCT]
	    보고 싶은 칼럼명, 보고 싶은 칼럼명, ...
	FROM 해당 칼럼들이 있는 테이블명;
	
	// 칼럼 별 데이터 선택
	SELECT 칼럼명 FROM 테이블명;
	
	// 데이터 중복 없이 선택
	SELECT DISTINCT 칼럼명 FROM 테이블명;
	
	// 전체 칼럼의 데이터 선택
	SELECT * FROM 테이블명;
	```
- `ALL` : Default 옵션이므로 별도로 표시하지 않아도 됨. 중복된 데이터가 있어도 모두 출력
- `DISTINCT` : 중복된 데이터가 있는 경우 1건으로 처리해서 출력
- `SELECT, FROM`은 필수이므로 생략되면 에러가 발생
- 앨리어스(Alias) : 
	- `SELECT 칼럼명 AS 별칭 FROM 테이블명` : 출력되는 칼럼명 설정
	- `SELECT 별칭.칼럼명 FROM 테이블명 AS 별칭` : 쿼리 내에서 사용할 테이블명 설정
- 문자열의 합성 연산자 : 
	- ‘+’(플러스)
	- CONCAT 함수로도 2개 문자열 합성 가능
	- Oracle에서는 ‘||’(수직선 2개)도 가능
- DUAL : Oracle의 기본 더미 테이블. 연산 수행을 위해 사용됨

### 2. TCL
#### 트랜잭션이란
- 트랜잭션 : DB의 논리적 연산 단위. 하나 이상의 SQL문을 포함함
- 트랜잭션의 특성 : ACID
	1) 원자성(Atomicity) : 전부 실행되거나 전혀 실행되지 않음 (All or Nothing)
	2) 일관성(Consistency) : 트랜잭션으로 인한 DB 상태의 모순이 없음
	3) 고립성(Isolation) : 부분적인 실행 결과에 다른 트랜잭션이 접근할 수 없음. LOCKING으로 고립성 보장
	4) 영속성(Durability) : 트랜잭션의 결과는 영구적으로 저장됨

#### TCL
- 논리적인 작업의 단위를 묶어 DML에 의해 조작된 결과를 작업단위(Transaction)별로 제어하는 명령어인 `Commit, Rollback, Savepoint` 등이 여기 해당
- 일부에서는 DCL로 분류하기도 함
- 데이터 무결성 보장을 목적으로 함
- 1) 영구 변경 전 확인과 2) 연관 작업 동시처리 가능
- ORACLE은 1) SQL 문장을 실행하면 트랜잭션이 시작되고 2) TCL을 실행하면 트랜잭션이 종료됨
- DDL을 실행하면 자동 커밋 (DML 이후 커밋없이 DDL을 실행해도 자동 커밋)
- DB를 정상적으로 종료하면 자동 커밋. 애플리케이션 등의 이상으로 DB 접속이 단절되면 자동 롤백

#### COMMIT
- COMMIT : 데이터를 DB에 영구적으로 반영하는 명령어
- 커밋 시 트랜잭션이 완료되어 LOCKING이 해제 됨
- SQL Server는 기본적으로 자동 커밋
- COMMIT 전 : 
	- 데이터 변경이 메모리 버퍼에만 영향을 받았기 때문에 복구 가능 (NOLOGGING 옵션 사용 시 버퍼 캐시의 기록을 생략하여 입력성능이 향상됨)
	- 사용자는 SELECT절로 결과를 확인할 수 있으나 다른 사용자는 현재 결과를 볼 수 없음
	- 변경된 행에 LOCKING이 설정되어 다른 사용자가 변경할 수 없음
- COMMIT 후 : 
	- 변경 사항이 DB에 반영되고 이전 데이터는 복구 불가
	- 모든 사용자가 결과를 볼 수 있음
	- LOCKING이 해제되어 다른 사용자가 행을 조작할 수 있음

#### ROLLBACK
- `ROLLBACK` : 
	- 트랜잭션 시작 이전의 상태로 되돌리는 명령어
	- COMMIT 이전 상태로 돌려줌
	- ROLLBACK 시 LOCKING이 해제됨
	- SQL Server에서는 'BEGIN TRAN'으로 명시해야 가능함
- `SAVEPOINT` : 
	- 트랜잭션 일부만 롤백할 수 있도록 중간상태를 저장하는 명령어
	- `ROLLBACK TO 저장점명` 시 해당 저장점 상태로 돌려줌
	- 동일한 저장점명이 있을 경우 나중 저장점이 유효함

### 3. DDL
#### CREATE
- 테이블 생성
	```
	CREATE TABLE 테이블명 (칼럼명 데이터타입 제약조건, …);
	```

- 테이블 및 칼럼 명명 규칙 : 
	- 다음은 사용 가능 : `(1)알파벳 (2)숫자 (3)'_'(언더바) (4)‘$’(달러) (5)‘#’(샵)`
	- 대소분자 구분하지 않음
	- 테이블명은 단수형 권고

- 제약조건 : 데이터 무결성 유지가 목적. 복제 테이블에는 기존 테이블 제약조건 중 NOT NULL만 적용됨
	1) `PRIMARY KEY` : 
		- 기본키. 테이블 당 하나의 기본키만 정의 가능
		- 기본키 생성 시 DBMS가 자동으로 인덱스를 생성함
		- NULL 불가
	2) `FOREIGN KEY` : 
		- 외래키. 다른 테이블의 기본키를 외래키로 지정함
		- 참조 무결성 제약조건
		- `ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 FOREIGN KEY(칼럼명) REFERENCES 테이블명(칼럼명);`
	3) `UNIQUE KEY` :
		- 행 데이터를 식별하기 위해 생성함
		- NULL 가능
	4) `DEFAULT` :
		- `DEFAULT 값` 으로 기본값 설정
	5) `NOT NULL` :
		- NULL이 되면 안될때 사용
	6) `CHECK` : 입력값의 종류 및 범위 제한
	
- DESCRIBE 테이블명, sp_help 'dbo.테이블명' : 테이블 구조 확인. 'DESCRIBE 테이블명'이 ANSI/ISO 표준

#### ALTER
- 칼럼을 추가/삭제하거나 제약조건 추가/삭제
- 칼럼 추가 : 
	- `ALTER TABLE 테이블명 ADD (칼럼명 데이터타입);`
	- 마지막 칼럼으로 추가됨 (칼럼 위치 지정 불가)
- 칼럼 삭제 : 
	- `ALTER TABLE 테이블명 DROP COLUMN 칼럼명;`
	- 삭제 후 복구 불가
- 칼럼 설정 변경 : 
	- `ALTER TABLE 테이블명 MODIFY (칼럼명 데이터타입 제약조건);`
	- 1) NULL만 있거나 2) 행이 없는 경우에만 칼럼의 크기 축소 가능
	- NULL만 있을 때는 데이터 유형도 변경 가능
	- NULL이 없으면 NOT NULL 제약조건 추가 가능
	- 기본값 변경 작업 이후 발생하는 데이터에 대해서만 기본값이 변경됨
- 칼럼명 변경 :
	- `ALTER TABLE 테이블명 RENAME COLUMN 칼럼명;`
	- ANSI/ISO 표준에 명시된 기능 아님
- 제약조건 추가 : 
	- `ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건;`
- 제약조건 제거 : 
	- `ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건;`

#### RENAME
```
RENAME 테이블명 TO 테이블명; (ANSI/ISO 표준)
```
- `ALTER TABLE 테이블명 RENAME TO 테이블명`으로도 가능함

#### DROP
```
DROP TABLE 테이블명;
```
- 테이블의 데이터와 구조 삭제. 복구 불가
- CASCADE CONSTRAINT 옵션으로 관련 테이블의 참조 제약조건도 삭제하여 참조 무결성을 준수할 수 있음 (CREATE TABLE에서 ON DELETE CASCADE 옵션으로도 동일 기능 실현 가능)

#### TRUNCATE
```
TRUNCATE TABLE 테이블명;
```
- 테이블의 전체 데이터 삭제 (<-> DROP TABLE은 테이블 자체를 제거함)
- 로그를 기록하지 않기 때문에 ROLLBACK 불가

### 4. DCL
- DCL : 유저를 생성하거나 권한을 제어하는 명령어. 보안을 위해 필요함

#### GRANT
```
GRANT 권한 ON 오브젝트 TO 유저명;
```
- 권한 부여

#### REVOKE
```
REVOKE 권한 ON 오브젝트 TO 유저명;
```
- 권한 제거

#### 권한(Privileges)
- `SELECT, INSERT, UPDATE, ALTER, ALL` : DML 관련 권한
- `REFERENCES` : 지정된 테이블을 참조하는 제약조건을 생성하는 권한
- `INDEX` : 지정된 테이블에서 인덱스를 생성하는 권한

#### Oracle의 유저
- `SCOTT` : 테스트용 샘플 유저
- `SYS` : DBA 권한이 부여된 최상위 유저
- `SYSTEM` : DB의 모든 시스템 권한이 부여된 DBA

#### ROLE
- ROLE : 권한의 집합. 권한을 일일이 부여하지 않고 ROLE로 편리하게 여러 권한을 부여할 수 있음'
- Oracle의 ROLE : 

| ROLE     | 권한                                                                                                                                                         |
| -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CONNECT  | CREATE SESSION                                                                                                                                             |
| RESOURCE | CREATE CLUSTER, <br>CREATE TRIGGER, <br>CREATE PROCEDURE, <br>CREATE OPERATOR, <br>CREATE TYPE, <br>CREATE TABLE, <br>CREATE SEQUENCE,<br>CREATE INDEXTYPE |
